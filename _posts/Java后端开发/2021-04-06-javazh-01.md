---
layout: post
title: JavaEE开发-第二节 MySQL
category: Java后端开发
tags: Java后端开发
description: Java后端开发
---   

### 简介
1. 通常会使用数据库（DataBase）来长久地存储数据
2. 使用数据库的明显好处？
    1. 可以高效地存储、查询数据
    2. 减少重复、冗余数据
    3. 提高数据的安全性
3. 常见的数据库
    1. 数据库分为：关系型数据库（Relational Database）、非关系型数据库（NoSQL Database)
    2. 关系型数据库
        1. MySQL、ORACLE、SYBASE、IBMDB2、PostgreSQL、SQLServer、SQLite
    3. 非关系型数据库
        1. redis、mongoDB
4. MySQL
    1. MySQL是一款开源的关系型数据库，有免费版（社区版）、商业版
        1. 2008年被Sun公司收购，Sun公司在2009年被Oracle公司收购
5. 下载
    1. 首先要下载安装MySQL服务器软件：MySQL Community Server(社区版)
        1. 常用版本：5.7、8.0，本课程使用的是5.7.29版本
    2. 下载地址
        1. windows：[https://downloads.mysql.com/archives/installer/](https://downloads.mysql.com/archives/installer/)
        2. Mac：[https://downloads.mysql.com/archives/community/](https://downloads.mysql.com/archives/community/)
    3. 官方文档
        1. [英文文档](https://dev.mysql.com/doc/refman/5.7/en/)
        2. [中文文档](http://www.searchdoc.cn/rdbms/mysql/dev.mysql.com/doc/refman/5.7/en/index.com.coder114.cn.html)
6. 安装MySQL
    1. 查看git代码库（学习时自己维护的）Doc文件夹下pdf文档
    2. 安装时会默认一个用户名root
7. **MySQL Server原理**
    1. MySQL Server是一个**服务器软件**，跟Tomcat一样，安装在服务器机器上
    2. 默认占用端口为3306，监听外部的请求
    3. 里面可以存放很多数据库，通常是一个项目一个数据库
8. MySQL的使用步骤
    1. 登录、连接MySQL服务器（管理员账户名是root)
        1. 方式1命令：`mysql -uroot -p密码`
        2. 方式2命令：`mysql -uroot -p`
    2. 使用SQL语句对数据库进行CRUD
        1. Create:创建，增
        2. Read:读取，查
        3. Update:更新，改
        4. Delete: 删除，删
    3. 在window中，可以通过以下命令查看占用3306端口号的进程ID
        1. `netstat -aon|findstr 3306`
    4. 使用步骤
        1. 创建一个数据库
        2. 在数据中添加表
        3. mysql默认情况下创建的有默认数据库
            
            ```
            information_schemamysql
            performance_schemasys
            ```
9. 数据库的内部存储细节
    1. 一个数据库(Database)中可以存放多张表（Table ）
    2. 每个表(Table)中包含一些列（Column,也叫做字段）
    3. 每个表(Table)中存放的数据,一般称为记录（record）

### SQL语句
1. SQL是Structured Query Language的简称，译为“结构化查询语言“，用于操作关系型数据库
2. SQL语句主要可以分为4大类
    1. DDL(Data Definition Language)
        1. 数据定义语言
        2. 创建(CREATE) 、修改(ALTER)、删除(DROP) **数据库\表**
            1. 注意操作的对象是：**数据库\表**
    2. DML(Data Manipulation Language)
        1. 数据操纵语言
        2. 增加 (INSERT) )、删除( (DELETE) 、修改 (UP DATE) **记录**
            1. 操作的对象是**记录**，即表中的每一行数据
    3. DQL (Data Q Query Language)
        1. 数据查询语言
        2. 查询**记录** (SE LECT)
    4. DCL (Data CControl Language)
        1. 数据控制语言
        2. 控制访问权限(GRANT、REVOKE)
3. 语句特点
    1. 每一条语句是分号（;）结束,语句输入完要加个分号，然后点击回车
    2. **不区分**大小写，建议：**关键字使用大写，其他使用小写，单词之间用下划线连接**，比如`my_firstname`
    3. 单行注释
        
        ```
        -- 注释内容 (--后要预留至少一个空格)
        #注释内容
        ```
    4. 多行注释
        
        ```
        /*注释内容*/
        ```
    5. 参考资料[官方文档 第13章 SQL语句语法](http://www.searchdoc.cn/rdbms/mysql/dev.mysql.com/doc/refman/5.7/en/sql-syntax.com.coder114.cn.html)
    
### GUI工具
1. 在实际开发过程中，经常会使用图形化界面工具来管理数据库。常用的有（均是付费软件）
    1. [Navicat Premium](http://www.navicat.com.cn/products/navicat-premium)
        1. 支持MySQL、MariaDB、MongoDB、SQLServer、Oracle、PostgreSQL、SQLite
        2. 使用：
            1. 点击左上角连接->选择数据库类型
            2. 设置地址、端口号、数据库密码，随便起一个连接名称，点击连接即可
            3. 查看mysql中的所有数据库，可以编辑
            4. 点击 新建查询，可以在里面输入SQL语句进行CURD操作，点击运行
    2. [SQLyog](https://www.webyog.com/product/sqlyog)
        1. 支持MySQL
        
### DDL语句

#### 数据库
1. 创建
    
    ```
    CREATE DATABASE 数据库名 # 创建数据库(使用默认的字符编码)
    CREATE DATABASE 数据库名 CHARACTER SET 字符编码 # 创建数据库(使用指定的字符编码)
    CREATE DATABASE IF NOT EXISTS 数据库名 # 如果这个数据库不存在，才创建它
    CREATE DATABASE IF NOT EXISTS 数据库名 CHARACTER SET 字符编码
    ```
2. 查询
    
    ```
    SHOW DATABASES # 查询所有的数据库
    SHOW CREATE DATABASE 数据库名 # 查询数据库的创建语句
    USE 数据库名 # 使用数据库,用于各个数据库之间的切换
    SELECT DATABASE() # 查询正在使用的数据库
    ```
3. 修改
    
    ```
    ALTER DATABASE 数据库名 CHARACTER SET字符编码 #修改数据库的字符编码
    
    ```
4. 删除
    
    ```
    DROP DATABASE 数据库名
    DROP DATABASE IF EXISTS数据库名 # 如果这个数据库存在，才删除它
    ```

#### 表
1. 创建（基本语法）
    
    ```
    CREATE TABLE表名(
        列名1 数据类型1，
        列名2 数据类型2，
        列名3 数据类型3，
        ...
        列名n 数据类型n
    )
    ```
2. 查询
    
    ```
    SHOW TABLES # 查询当前数据库的所有表
    DESC 表名 # 查看表结构
    ```
3. 删除
    
    ```
    DROP TABLE 表名
    DROP TABLE IF EXISTS 表名 # 如果这个表存在，才删除它
    ```
4. 修改
    
    ```
    ALTER TABLE 表名 RENAME TO 新表名 # 修改表名
    ALTER TABLE 表名 CHARACTER SET 字符编码 # 修改表格的字符编码
    ALTER TABLE 表名 ADD 列名 数据类型 # 增加新的-列
    ALTER TABLE 表名 MODIFY 列名 新数据类型 #修改 某一列的数据类型
    ALTER TABLE 表名 CHANGE 列名 新列名 新数据类型 # 修改某一列的列名、数据类型
    ALTER TABLE 表名 DROP列名 # 删除某一列
    ```

### 常用数据类型
#### 数字类型
1. 整型
    
    ```
    类型                      字节  有符号取值范围             无符号取值范围
    TINYINT\BOOL\BOOLEAN      1     -128~127                0~255
    SMALLINT                  2     -32768~32767            0~65535
    MEDIUMINT                 3     -8388608~8388607        0 ~ 16777215
    INT\INTEGER               4     -2147483648~2147483647  0~4294967295
    BIGINT                    8     -9223372036854775808~   0~18446744073709551615
                                    9223372036854775807
    ```
    
    1. 上述整数类型的使用格式为：`TYPE[(M)] [UNSIGNED] [ZEROFILL]`
        1. UNSIGNED：无符号
        2. ZEROFILL：等价于UNSIGNED ZEROFILL，表示在显示数值时，若数字不足M位， 就在前面用0填充
        3. 中括号代表可有可无，M代表数字
2. 浮点类型
    
    ```
    类型                          字节              描述
    FLOAT                          4            存储的小数是近似值
    DOUBLE\DOUBLE PRECISION        8            存储的小数是近似值
    DECIMAL\DEC\NUMERIC\FIXED     看情况         存储的小数可以更加精确
    ```
    
3. 参考资料
    1. [【官方文档】11.1.1数字类型概述](http://www.searchdoc.cn/rdbms/mysql/dev.mysql.com/doc/refman/5.7/en/numeric-type-overview.com.coder114.cn.html)
    2. [【官方文档】11.8数据类型存储要求](http://www.searchdoc.cn/rdbms/mysql/dev.mysql.com/doc/refman/5.7/en/storage-requirements.com.coder114.cn.html)

#### 字符串类型

```
类型          描述
CHAR        长度可以指定为0~255,查询数据时，会省略后面的空白字符
VARCHAR     长度可以指定为0~65535(较常使用),查询数据时，不会省略后面的空白字符
BLOB        用于存储二进制数据(照片、文件、大文本等)
TEXT        用于存储大文本
```

1. 参考资料
    1. [【官方文档】11.4.1CHAR和VARCHAR类型](http://www.searchdoc.cn/rdbms/mysql/dev.mysql.com/doc/refman/5.7/en/char.com.coder114.cn.html)

#### 日期和时间类型

```
类型          字节(MySQL 5.6.4之前) 字节(MySQL 5.6.4开始)   显示格式
YEAR            1                   1                   YYYY
DATE            3                   3                   YYYY-MM-DD
TIME            3                   3+小数秒存储         HH：MM：SS[.fraction]
DATETIME        8                   5+小数秒存储         YYYY-MM-DDHH：MM：SS[.fraction]
TIMESTAMP       4                   4+小数秒存储         YYYY-MM-DDHH：MM：SS[.fraction]
```

1. 从MySQL 5.6.4开始， 允许TIME\DATETIME\TIMESTAMP有小数部分，需要0~3字节的存储
2. DATETIME支持的范围：1000-01-01 00：00：00.000000到9999-12-31 23：59：59.999999
3. TIMESTAMP支持的范围：1970-01-01 00：00：01.000000到2038-01-19 03：14：07.999999

#### DATETIME\TIMESTAMP的自动设置（重要！！！）
1. DEFAULT CURRENT_TIMESTAMP
    1. 默认当前时间戳：当插入记录时，如果没有指定时间值（原来表中有时间值字段），就设置时间为当前的系统时间
2. ON UPDATE CURRENT_TIMESTAMP
    1. 当修改记录时，如果没有指定时间值（原来表中有时间值字段），就设置时间为当前的系统时间
3. 注意：上面1，2就是为了修饰DATETIME\TIMESTAMP这2个类型
    1. 比如新建一个表有：姓名、年龄、生日、添加记录时间、修改记录时间等字段，添加记录时间字段类型是DATETIME用DEFAULT CURRENT_TIMESTAMP修饰，修改记录时间段类型是DATETIME用ON UPDATE CURRENT_TIMESTAMP修饰
    2. 添加一条数据没有设置添加时间
    3. 修改一条数据没有设置修改时间

### DML语句


