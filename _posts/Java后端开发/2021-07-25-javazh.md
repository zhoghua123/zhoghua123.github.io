---
layout: post
title: SpringBoot（二）
category: Java后端开发
tags: Java后端开发
description: Java后端开发
--- 

## 页面模板
1. SpringBoot中常用的页面模板有
    1. JSP
    2. Freemarker
    3. Thymeleaf(推荐)

### JSP
1. 新建子项03_jsp
2. 在pom.xml中添加依赖如下：
    
    ```
    <dependencies>
        <dependency>
            <groupId>org.apache.tomcat.embed</groupId>
            <artifactId>tomcat-embed-jasper</artifactId>
        </dependency>
    </dependencies>
    ```
3. 配置视图的前缀、后缀、热部署
    1. 在resources下添加一个application.yml
        
        ```
        #配置前后最
        spring:
          mvc:
            view:
              # jsp放在了webapp根路径下
              prefix: /
              suffix: .jsp
        #jsp的热部署
        server:
          servlet:
            jsp:
              init-parameters:
                - developement: true
        ```
    2. 添加webapp路劲
        1. 点击右上角Project Structure
        2. 找到03_jsp->web->右边Web Resources Directories->点击下面的+，Web Resources Directory path路径后面添加`/src/main/webapp`,点击OK
        3. 在webapp下添加一个test.jsp
4. 设置工作目录（Working directory)
    1. 点击Eidt Configurations ->Spring Boot->Application(当前项目的启动入口类)->Working directory设置->点击右边的+加号->选择Macros下的ModuleFileDir->点击insert->点击OK
    2. 控制器做如下改造
        
        ```
        //注意不能使用RestController
        @Controller
        public class TestController {
        
            @GetMapping("/index")
            public String index() {
                //会自动拼接前后缀， /test.jsp
                return "test";
            }
        }
        ```
    3. 运行项目，在浏览器输入`http://localhost:8080/index`
    4. 如果是使用Sring-boot-maven-plugin运行，可以不用设置这一项
        1. 在父项目22_spparent的pom.xml中添加
            
            ```
            <dependency>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <version>2.3.4.RELEASE</version>
            </dependency>
            ```
            
### Thymeleaf
1. Thymeleaf是在SpringBoot中推荐使用的页面模板引擎
    1. 可以完全取代JSP
    2. 可以在没有服务器的环境下展示静态页面
2. 官网[https://www.thymeleaf.org](https://www.thymeleaf.org)
3. 简单使用
    1. 新建子项目04_thymeleaf
    2. pom.xml添加依赖
        
        ```
        <dependencies>
            <dependency>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-starter-thymeleaf</artifactId>
            </dependency>
        </dependencies>
        ```
    3. 一些默认配置：只要引入上面的库，相当于做了下面的配置
        
        ```
        spring:
          thymeleaf:
            #返回的数据编码
            encoding: UTF-8
            # 默认前后缀
            prefix: classpath:/templates/
            suffix: .html
            #开启thymeleaf模板功能
            enabled: true
            #返回的数据格式
            servlet:
              content-type: text/html
        ```
    4. resources下面新建一个templates文件夹
        1. 下面新建一个index.html
        2. 浏览器输入`http://localhost:8080/templates/index.html`但是无法打开
        3. templates中的资源必须通过转发才能访问
        4. 在控制器中做一个转发
            
            ```
            //注意不能使用RestController
            @Controller
            public class TestController {
                @GetMapping("/testIndex")
                public String testIndex() {
                    // prefix: classpath:/templates/
                    // suffix: .html
                    //转发到的最终路径
                    // classpath:/templates/index.html
                    return "index";
                }
            }

            ```
        5. 浏览器输入`http://localhost:8080/testIndex`，这可以正常访问index.html
4. 页面传值
    1. 控制器中转发如下
        
        ```
        //方法1：
        @GetMapping("/testIndex")
        public String testIndex(Model model) {
    
            model.addAttribute("name", "ZH");
            model.addAttribute("age", 22);
            //向index.html传值
            return "index";
        }
        //方法二：
        @GetMapping("/testIndex")
        public String testIndex(HttpServletRequest request) {
            //向index.html传值
            request.setAttribute("name", "ZH");
            request.setAttribute("age", 20);
            return "index";
        }
        ```
    2. index.html如下：
        
        ```
        <!DOCTYPE html>
        <!--需要导入这个命名空间-->
        <html lang="en" xmlns:th="http://www.thymeleaf.org">
        <head>
            <meta charset="UTF-8">
            <title>Title</title>
        </head>
        <body>
        
        This is index.html
        <div th:text="${name}"></div>
        <div th:text="${age}"></div>
        </body>
        </html>
        ```

