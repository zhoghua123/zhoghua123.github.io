---
layout: post
title: Java常用企业框架-Spring(五)
category: Java后端开发
tags: Java后端开发
description: Java后端开发
--- 

## 注解
1. 注解实现bean标签
    1. `@Component`   
        1. 相当于`<bean>`
        2. 通过value属性设置bean的id，默认会将类名的首字母小写形式作为bean的id
        3. `@Controller`用于标识控制器层，`@Service`用于标识业务层，`@Repository`用于标识Dao层
    2. `@Scop`e：设置singleton、prototype
    3. `@Lazy`：scope为singleton时延迟加载
    4. 可以通过`<context：component-scan>`设置需要扫描的包，可以扫描到所有的`@Component`
        1. `@ComponentScan`：相当于`<context:component-scan>`标签 
    5. 举例使用
        1. 在applicationContext.xml文件中设置需要扫描那些包含注解的文件
            
            ```
            <!--扫描指定包下面的所有注解-->
            <!--注意：只能扫描到domain下的文件，不能扫描dao、service、servlet层的文件，但是可以通过注解@ComponentScan来附加扫描其他文件-->
            <context:component-scan base-package="com.zh.domain"/>
            ```
        2. domain下的person类注解如下：
            
            ```
            //等价于bean标签，默认id为类名小写person
            @Component
            //指定bean的id为personx
            //@Component("personx")
            //在容器中是否唯一
            @Scope("singleton")
            //等价于标签的lazy-init = true
            @Lazy
            //让入口xml文件，附加扫描其它的包
            @ComponentScans({
                    @ComponentScan("com.zh.service"),
                    @ComponentScan("com.zh.dao"),
                    @ComponentScan("com.zh.servlet")
            })
            public class Person {
            
            }
            ```  
        3. MyTest测试代码
            
            ```
            ApplicationContext ctx = new ClassPathXmlApplicationContext(
                "applicationContext.xml");
            System.out.println(ctx.getBean("person"));
            System.out.println(ctx.getBean("user"));
            System.out.println(ctx.getBean("userService"));
            ```
    2. 注解实现注入
        1. `@Autowired`：默认按照类型注入bean实例
            1. 可以写在成员变量(不会调用setter)、setter、构造方法上
            2. 可以配合使用`@Qualifier`、`@Named`：设置需要注入的bean的id
            3. required设置为false：找不到对应的bean时不会抛出异常
        2. `@Value`
            1. 用于注入String、基本类型、BigDecimal等类型
            2. 可以配合配置文件(比如properties)使用`${}`读取配置文件的内容
        3. `@PropertySources、@PropertySource`
            1. 相当于`<context:property-placeholder>`
        4. 构造方法
            1. 可以通过`@Autowired`指定创建bean时调用的构造方法
                
                ```
                public Student (){};
                //创建bean时会调用这个构造方法
                @Autowired
                public Student(@Value("zh") String name,
                               @Qualifier("dog") Dog dog){
                    this.name = name;
                    this.dog = dog;
                }
            
                //@Nullable会注入null值
                @Autowired
                public Student(@Nullable String name,
                               @Qualifier("dog") Dog dog){
                    this.name = name;
                    this.dog = dog;
                }
                ```
        5. 举例使用：
            1. 注解User类
                
                ```
                @Component
                //导入配置文件，相当于<context:property-placeholder>，有了这个下面就可以使用配置文件中的动态引用了 @Value("${name}")
                @PropertySource("user.properties")
                public class User {
                    //基本数据类型注入一个动态的值
                    @Value("${name}")
                    private String name;
                
                    //也可以直接放到成员变量上，不用放到set方法上，甚至不用写set方法
                    //@Autowired
                    private Dog dog;
                
                    //基本数据类型注入一个确定的值
                    //@Value("jack")
                    //也可以放在set方法前面
                    //@Value("${name}")
                    public void setName(String name) {
                        this.name = name;
                    }
                
                    //自动注入
                    //@Autowired
                    //required = false：找不到bean对象不会报错
                    @Autowired(required = false)
                    //指定id值为dog的bean对象进行注入
                    @Qualifier("dog")
                    public void setDog(Dog dog) {
                        this.dog = dog;
                    }
                }
                ```
            2. user.properties内容
                
                ```
                name=Rose
                ```

