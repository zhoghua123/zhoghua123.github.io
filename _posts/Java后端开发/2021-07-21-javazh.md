---
layout: post
title: Maven补充
category: Java后端开发
tags: Java后端开发
description: Java后端开发
--- 

## 依赖冲突
1. 什么是依赖冲突
    1. spring-webmvc、spring-jdbc都依赖spring-beans
    2. 如果spring-webmvc的版本是5.2.6，那么它依赖的spring-beans默认版本也是5.2.6
    3. 如果spring-jdbc的版本是5.2.8，那么它依赖的spring-beans默认版本也是5.2.8
    4. 如果将5.2.6版本的spring-webmvc、5.2.8版本的spring-jdbc放一起
        1. 会出现2个版本的spring-beans
        2. 这就是产生了依赖冲突
        3. 需要想办法只保留一个版本的spring-beans

### 依赖冲突的解决方案

#### 1.方案一：
1. Maven默认情况下：优先保留前面先声明的版本
2. 根据下面的代码，最终spring-beans将会是5.2.6
    
    ```
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>5.2.6.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-jdbc</artifactId>
        <version>5.2.8.RELEASE</version>
    </dependency>
    ```
    
#### 2.方案二：
1. 单独为依赖库增加dependency指定版本号
2. 根据下面的代码，最终spring-beans将会是5.2.8
    
    ```
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>5.2.6.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-jdbc</artifactId>
        <version>5.2.8.RELEASE</version>
    </dependency>
    <!-- 直接指定使用哪个版本 -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-beans</artifactId>
        <version>5.2.8.RELEASE</version>
    </dependency>
    ```

#### 3.方案三：
1. 使用exclusion排除某个依赖
2. 根据下面的代码，最终spring-beans将会是5.2.6
    
    ```
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-jdbc</artifactId>
        <version>5.2.8.RELEASE</version>
        <!-- 删除当前包依赖的spring-beans -->
        <exclusions>
            <exclusion>
                <groupId>org.springframework</groupId>
                <artifactId>spring-beans</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>5.2.6.RELEASE</version>
    </dependency>
    ```

#### 4.方案四：
1. 最常用的解决方案：使用dependencyManagement锁定依赖库的版本号
2. 根据下面的代码，最终spring-beans将会是5.2.8
3. 注意： dependencyManagement只是声明版本号，并不会触发下载导入依赖库

    ```
    <properties>
        <spring.version>5.2.9.RELEASE</spring.version>
    </properties>

    <!-- 仅用于锁定库的版本号，并不会去下载导入库-->
    <dependencyManagement>
        <dependencies>
            <dependency>
                <groupId>org.springframework</groupId>
                <artifactId>spring-beans</artifactId>
                <version>${spring.version}</version>
            </dependency>
        </dependencies>
    </dependencyManagement>
    
    <!-- 会去下载导入库 -->
    <dependencies>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-jdbc</artifactId>
            <version>5.2.8.RELEASE</version>
        </dependency>
    
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
            <version>5.2.6.RELEASE</version>
        </dependency>
    </dependencies>
    ```

### 自定义属性
1. 通过dependencyManagement指定好版本，然后dependency中不需要在写版本
    
    ```
    <!--统一设置所有依赖的版本号-->
    <properties>
        <spring.version>5.2.9.RELEASE</spring.version>
    </properties>
    
    <!--统一固定所有依赖的版本号码-->
    <dependencyManagement>
        <dependencies>
            <dependency>
                <groupId>org.springframework</groupId>
                <artifactId>spring-webmvc</artifactId>
                <version>${spring.version}</version>
            </dependency>
            <dependency>
                <groupId>org.springframework</groupId>
                <artifactId>spring-jdbc</artifactId>
                <version>${spring.version}</version>
            </dependency>
        </dependencies>
    </dependencyManagement>
    
    <!--不用在设置版本号-->
    <dependencies>
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-jdbc</artifactId>
        </dependency>
    
        <dependency>
            <groupId>org.springframework</groupId>
            <artifactId>spring-webmvc</artifactId>
        </dependency>
    </dependencies>
    ```


