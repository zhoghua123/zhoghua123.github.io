---
layout: post
title: JavaEE开发-第一节 简介
category: Java后端开发
tags: Java后端开发
description: Java后端开发
---   

## 简介
1. JavaEE开发
    1. 在Java的三大版本JavaSE、JavaME、JavaEE中，JavaEE是专门用来做后台开发的
    2. 所以，平时所说的“Java后台开发“，一般叫做JavaEE开发
    3. JavaEE开发的工作内容
        1. 编写服务器上运行的程序，为客户端提供数据服务
        2. 很多大型网站、企业管理系统的后台，都是用JavaEE开发的
2. 服务器
    1. 用户量、数据访问量越大，对服务器的性能要求越高
    2. 一般中大型企业都有自己独立的服务器机房，摆放着成群的服务器
    3. 服务器的一些维护成本：电费、场地、维修等
    4. 小型企业可以考虑租用云服务器（比如阿里云、腾讯云服务器）
    5. 宕(dang)机
        1. 服务器死机、挂了
        2. 停止对外服务
        3. 客户端无正确响应
        4. 严重影响用户体验

## Servlet_JSP

### Servlet
1. Servlet是Server Applet的简称，译为“小型的服务程序”，**用于响应客户端的请求**
2. 一般的使用要素
    1. 继承java.servlet.http.HttpServlet,实现doGet、doPost或者service方法
    2. 通过request对象获取客户端的请求数据：`request.getParameter()`
    3. 通过response对象给客户端返回响应: `response.getWriter().write()`
    4. 通过注解@WebServlet设置Servlet对应的请求路径
3. 乱码问题解决
    1. 客户端的请求数据乱码
        
        ```
        //按照UTF8编码解析客户达发送过来的数据
        request.setCharacterEncoding("UTF-8");
        ```
    2. 服务器的响应数据乱码
        
        ```
        //设置响应数据的编码
        response.setContentType("text/plain;charset=UTF-8");
        ```
        
        1. 其中`text/plain`是数据的MINEType,根据实际情况而定
        2. 更多的MINEType可以参考Tomcat安装目录下的conf文件夹下/web.xml文件中可以查看
4. 一些细节
    1. 通过response拿到的输出流对象（比如getWriter），不需要程序员调用close去关闭
        1. 在语法基础IO流中讲过，流一般创建了，需要用close销毁，这里是获取，不是创建所以不用销毁
    2. 默认情况下，一个Servlet类，只会被服务器创建一个实例对象，而且是在第一次处理客户端请求才创建实例
        1. 注意：**Servlet并没有设计成单例模式！！！**
    3. 建议：不要在Servlet中定义可写（writable）的成员变量，会引发线程安全问题
    4. HTTP请求的默认端口号是80,，所以，如果Tomcat服务器的端口号设置为80，那么
        1. localhost/path等价于localhost:80/path（**仅仅是HTTP请求**才会自动加上80）
        2. 也就是说如果Tomcat服务器的端口号设置的不是80，那么HTTP请求的时候就必须是`域名(IP地址):+端口号`进行访问
        3. **注意**:这里的80不等于8080
        4. **HTTPS请求**的默认添加端口号是443
5. 代码举例：
    
    ```
    //TestServlet类
    package com.example.HelloWorld;
    import javax.servlet.ServletException;
    import javax.servlet.annotation.WebServlet;
    import javax.servlet.http.HttpServlet;
    import javax.servlet.http.HttpServletRequest;
    import javax.servlet.http.HttpServletResponse;
    import java.io.IOException;
    
    //设置请求路径
    @WebServlet("/login")
    //设置多个请求路径
    //@WebServlet({"/login","/test"})
    public class TestServlet extends HttpServlet {
        //可以从构造方法中看出，n个请求发送过来，TestServlet对象仅仅被创建一次
        public TestServlet(){
            //java中打印一个对象时，输出：类名@哈希值，每个对象都有唯一的哈希值，如果2个对象打印的值一样，说明2个对象是同一个对象
            System.out.println(this + "server");
        }
        /**
         * 客户端发送一个http请求，首先会调用这个service方法
         * */
        @Override
        protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
            //父类的service方法内部已经做好了分发，会判断当前客户端的请求是get还是post，然后分别调用doGet、doPost
            super.service(req, resp);
            System.out.println("------service-----------");
            //java中打印一个对象时，输出：类名@哈希值，每个对象都有唯一的哈希值，如果2个对象打印的值一样，说明2个对象是同一个对象
            System.out.println(this + "server");
        }
    
        //处理get请求
        @Override
        protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
            System.out.println("------doget-----------");
            //统一函数处理
            doPost(req,resp);
        }
        //处理post请求
        /**
         * HttpServletRequest req: 请求，用来获取客户端发送的数据
         * HttpServletResponse resp：响应，用来给客户端返回数据
         * */
        @Override
        protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
            System.out.println("-------dopost---------");
            //获取客户端发送的数据（请求参数）
            //按照UTF8编码解析客户达发送过来的数据
            req.setCharacterEncoding("UTF-8");
            String username = req.getParameter("username");
            String password = req.getParameter("password");
            System.out.println(username + "---" + password);
            //设置响应数据的MINE Type和数据编码
            resp.setContentType("text/plain;charset=UTF-8");
            //2. 判断
            if("123".equals(username) && "456".equals(password)){
                System.out.println("登录成功");
                resp.getWriter().write("Login Success!");
            }else {
                System.out.println("登录失败");
                resp.getWriter().write("Login Error!");
            }
        }
    }
    ```


