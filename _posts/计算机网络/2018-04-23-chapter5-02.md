---
layout: post
title: 第五章 网络层(二)
category: 计算机网络
tags: 计算机网络
description: 计算机网络
---

## Internet中的网络层

### Internet 综述
1. Internet的发展
    1. 1970年：第一个分组交换网ARPA诞生，连接了四所大学
    2. 1972年：ARPA网有40个网点，应用有e-mail、rlogin、FTP，至此，网络的核心技术产生并开始研究网络的互联
    3. 1974年：产生了两个基本的Internet协议：IP协议和TCP协议
    4. 80年代后期：产生了NSF网，它连接了美国所有的超级计算中心，并逐步取代了ARPA网
2. 技术特点
    1. 使用TCP/IP协议 
        1. 因特网是怎样把全球不同的网络互联起来的呢?
        2. 它建立了一个虚拟的网络,他不管这个世界上有多少网络,它提供一个世界语
        3. 你这台机器在你自己的网络传输信息的时候,那就用自己的网络协议去传输,如果你要跟其他的网络交换信息的话,那你要把你这个信息变成世界语的格式来传递,那么这个世界语就是TCP/IP协议
    2. 网络互联结构：各网之间一般采用路由器加专线连接 
        1. 各个网络之间是怎样互连起来的呢?
        2. 网络1+路由器---专线----路由器+网络2
        3. 所有的路由器都认识TCP/IP
        4. 路由器既可以理解子网络的语言,也认识世界语言(TCP/IP)
    3. 层次结构的域名及网络管理 
        1. 这么大的一个网络,他是怎样确定他的网络资源呢?请求网络就是为了获取网络的资源
        2. 因特网给他所有资源规定了一个唯一命名的规则-这个名字就是**域名**
        3. 怎样保证域名的唯一性呢? 采用的就是层次结构
    4. 分布式的管理模式，没有一个Internet管理中心 
    5. 开发了通用的应用技术
3. TCP/IP分层模型 
    1. 应用层(应用层+表示层)
    2. 传输层(传输层+会话层)
    3. 互联网层(网络层+网络互联功能)
    4. 主机至网络
    5. 分析:
        1. TCP/IP跟七层网络协议不一样,他是一个四层的协议
        2. 层和层之间是通过网络结构来调用的,层和层之间的接口就相当于是一个函数调用
        3. TCP协议和OSI协议不一样,OSI是一个完整的网络协议,二TCP/IP他只是一个把网络互联起来的协议,他只考虑让两个网络互相认识,至于子网内部的传输,不管
        4. 因此最后一层归纳为主机至网络的一个接口,即网络层到数据链路层的一个接口
4. Internet的发展方向
    1. Internet 2：美国各大学，主要解决QoS 
    2. Ipng：(Next Generation Internet) 美国政府组建机构研究，主要解决已有的Internet的一些限制，如地址、安全和多媒体传输等问题 
5. Internet 中的"I"的注意: 
    1. 如果大写,代表全球最大的互联网因特网
    2. 如果小写即internet,代表网络互联技术
    
### IP 协议 
1. 在TCP/IP协议当中他的网络层就是互联网层,互联网层他的主要的协议就是IP协议(当然还有其他协议)
2. IP协议就是网络互联的协议(Internet Protocol)
3. IP协议主要就是完成了在不同的网络当中怎样来传递数据包
4. IP协议提供了一种公共的数据包格式
5. 在分组交换的网络中怎样来实现网络的互联呢?有3个问题需要解决
    1. 各个不同的网络他的数据包的格式是不一样的
        1. 采用了一种统一的数据包格式-**IP包格式**
    2. 每一个网络的地址是不一样的,比如:发送方网络地址有2个字节,而接收方网络地址是4个字节,那么怎样把4个字节地址放到2个字节的物理帧里面呢?
        1. 显然是不可行的,因此,在网络互联的情况下,所有的站点都给他赋一个虚拟的地址,不管你在你的物理网络当中的地址是什么,都给他附一个虚拟的地址-**IP地址**
        2. 举例说明: 就像联合国开大会,每个国家都派代表开会,每个代表在自己的国家都有自己的名字(自己的网络当中的地址),但是在开大会的时候,会给每一个国家的代表起一个名字(**代表),这个名字就是全球唯一的,这就是IP的地址
    3. 不同的网络有不同的长度,就是在IP协议当中怎样解决**分段和重组的问题**

#### IP包格
1. 它是在整个因特网上每个路由器都认识的数据包的格式
2. IP数据包格式如下
    
    ![图1](https://raw.githubusercontent.com/zhoghua123/imgsBed/master/PCNet26.png)
3. 数据包分为包头部分+SDU部分(真正的传输层交过来的数据)
    1. 数据包的包头又分为固定部分和可变部分
        1. 固定部分是每一个数据包都有这些字段
        2. 而可变部分是如果你需要由这个功能你可以增加
        3. 因此IP包的包头最小长度是,最短的长度是前面的固定部分(有五行,每行4个字节)20个字节(20B)
4. 包头20个固定字节的内容
    1. IP协议的版本号
        1. 版本为4（Ipv4）
    2. 头部的长度
        1. 头部长以32位字长(即4个字节)为单位, 即一行
    3. 服务类型(基本没用)
        1. 8位（两位保留）
    4. 总长：
        1. 包括报头和数据报，最长216 –1(2个字节)，即	65535个字节 
    5. 标识、标志、段偏移：
        1. 用于数据报的分段 
    6. 生存时间：
        1. 以秒为单位也,可以经过路由器的个数为单位 
    7. 类型或协议 
        1. 指的是承载的数据是什么类型的
        2. IP协议通过这个字段把数据包解析,判断交给上层的哪个协议(UDP/TCP...)
            1. TCP: 6
            2. UDP: 17
            3. ICMP: 1
            4. OSPF: 89
    8. 头部校验和
        1. 按16位相加，结果求反 
    9. 源和目的地址：32位
    10. IP可选项：用于控制和测试 
        ![图1](https://raw.githubusercontent.com/zhoghua123/imgsBed/master/PCNet27.png)
    11. 充填域：凑成32位的整倍数 
    
#### P包的分段与重组

#### IP地址

### IP 控制协议 
### IP 路由 
### IPv6 


