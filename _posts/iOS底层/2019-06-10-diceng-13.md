---
layout: post
title: iOS底层-多线程
category: iOS底层
tags: iOS底层
description: iOS底层
---  

## 简介
1. iOS中的常见多线程方案 
    ![图4](https://raw.githubusercontent.com/zhoghua123/imgsBed/master/diceng20.png)
2. GCD的常用函数 
    1. GCD中有2个用来执行任务的函数
        1. 用同步的方式执行任务
            
            ```
            dispatch_sync(dispatch_queue_t queue, dispatch_block_t block);
            üqueue：队列
            üblock：任务
            ```
        2. 用异步的方式执行任务
            
            ```
            dispatch_async(dispatch_queue_t queue, dispatch_block_t block);
            ```
    2. GCD源码：[https://github.com/apple/swift-corelibs-libdispatch](https://github.com/apple/swift-corelibs-libdispatch)
2. GCD的队列
    1. GCD的队列可以分为2大类型
        1. 并发队列（Concurrent Dispatch Queue）
            1. 可以让多个任务并发（同时）执行（自动开启多个线程同时执行任务）
            2. 并发功能只有在异步（dispatch_async）函数下才有效
        2. 串行队列（Serial Dispatch Queue）
            1. 让任务一个接着一个地执行（一个任务执行完毕后，再执行下一个任务）
3. 容易混淆的术语 
    1. 有4个术语比较容易混淆：同步、异步、并发、串行
        1. 同步和异步主要影响：能不能开启新的线程
            1. 同步：在当前线程中执行任务，不具备开启新线程的能力
            2. 异步：在新的线程中执行任务，具备开启新线程的能力
        2. 并发和串行主要影响：任务的执行方式
            1. 并发：多个任务并发（同时）执行
            2. 串行：一个任务执行完毕后，再执行下一个任务
4. 各种队列的执行效果 
    ![图4](https://raw.githubusercontent.com/zhoghua123/imgsBed/master/diceng21.png)
    
    1. 注意：**使用sync函数往当前串行队列中添加任务，会卡住当前的串行队列（产生死锁）**
    
    

