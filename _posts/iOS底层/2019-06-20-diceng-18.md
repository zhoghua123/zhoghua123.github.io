---
layout: post
title: iOS底层-性能优化
category: iOS底层
tags: iOS底层
description: iOS底层
---   

## CPU和GPU 
1. 在屏幕成像的过程中，CPU和GPU起着至关重要的作用
2. CPU（Central Processing Unit，中央处理器）
    1. 对象的创建和销毁、对象属性的调整、布局计算、文本的计算和排版、图片的格式转换和解码、图像的绘制（Core Graphics）
3. GPU（Graphics Processing Unit，图形处理器）
    1. 纹理的渲染
    
    ![图4](https://raw.githubusercontent.com/zhoghua123/imgsBed/master/diceng27.png)
    
    1. 手机屏幕上显示的文字和图片都是CPU和GPU配合处理显示出来的
    2. CPU负责计算，比如：文字的大小、颜色、位置，图片的解码等
    3. CPU将计算好的数据提交给GPU，GPU将计算好的数据进行渲染
    4. 只有通过GPU渲染过的才能显示到屏幕上
        1. CPU直接计算出来的数据是无法显示在屏幕上的
        2. 屏幕想要显示数据必须有固定的格式
        3. GPU专门是处理这个的，将CPU计算好的数据处理成屏幕上可以显示的格式
        4. 这个过程叫做渲染
    5. GPU将渲染后的数据放在了**帧缓存**中（一个缓冲区）
    6. **视屏控制器**从帧缓存中读取数据，然后直接将这些数据显示在屏幕上
4. 在iOS中是双缓冲机制，有前帧缓存、后帧缓存
    1. 意思就是iOS有2块帧缓存，可以相互协调
    2. 这样效率比较高

    
### 屏幕成像的原理

![图4](https://raw.githubusercontent.com/zhoghua123/imgsBed/master/diceng28.png)
    
1. 屏幕上的画面都是帧一帧的显示的，就像电影交卷一样
2. 要显示一帧画面时，先发出垂直同步信号，这就意味着要显示一页的数据
3. 然后发出一条水平同步信号，填充一行
4. 接着再次发出一套水平同步信号，填充下一行，直到填满整个帧
5. 然后在发出一条垂直同步信号，显示下一帧。。。
6. 每一帧连起来，就是画面了

### 卡顿产生的原因 
1. 下图
    ![图4](https://raw.githubusercontent.com/zhoghua123/imgsBed/master/diceng29.png)
    
    1. 
    


