---
layout: post
title: 第五章：豆瓣项目之自定义组件、自定义导航栏
category: 小程序开发
tags: 小程序
description: 小程序开发
--- 

## 自定义组件
1. 一个组件包括： js、wxml、wxss、json
2. 场景：由于首页的电影item与电影列表里面的item一样，因此考虑把电影item封装成一个组件movie-item
3. 操作步骤
    1. 打开“微信开发者工具”，点击左上角的“+”，在主目录下创建一个cmps文件夹，与pages同级
    2. 然后右击“新建 目录” -> movie-item文件夹
    3. 右击“movie-item” 新建component(组件)，命名为movie-item（**注意微信小程序官方定义的组件都用-表示**）
4. 封装组件：
    1. 组件movie-item.wxml内部封装
        
        ```
        //movie-item 组件wxml，添加事件监听： bind:tap
        <view class="item" bind:tap="detail" >
            *{name}} + *{ size}}
        </view>
        ```
    2. 组件传值、事件传递movie-item.js
        1. 在properties字段中自定义属性，用来传递值
        2. 在methods中可以将当前组件操作的所有事件传递出去，提供外面监听
    
        ```
        // cmps/movie-item/movie-item.js
        Component({
          /**
           * 组件的属性列表
           */
          properties: {
            // 属性
            name:{
              // 类型
              type: String,
              // 值
              value: ''
            },
            // 属性
            size:{
              type: Number,
              value: 0
            }
          },
          /**
           * 组件的初始数据
           */
          data: {
        
          },
          /**
           * 组件的方法列表
           * 时间处理方法
           */
          methods: {
            // 时间监听
            detail: function() {
              console.log('-------');
               //事件传递： 将事件传递出去，相当于block闭包，同时传递一个对象出去
               this.triggerEvent('movieItemClick',{age: 18})
            }
          }
        })
        ```
5. 使用组件
    1. 在home.json中表明使用哪个组件
        
        ```
        {
          "usingComponents":{
            //组件名称（可以随便写，但是使用的时候用这个）: 组件路径
            "movie-item":"/cmps/movie-item/movie-item"
          }
        }
        ```
    2. 组件外部使用home.wxml：属性传值、事件监听
        
        ```
        <movie-item  
        name="hhh" 
        size="18"
        //home页面监听组件movie-item的点击事件
        bind:back ="movieItemClick"
        >
        </movie-item>
        ```
    3. home.js中响应
        
        ```
         Page({
          //监听组件movie-item的点击
          movieItemClick: function(evt){
            console.log('back监听',evt.detail);
          },
        })
        ```

## TabBar的设置
1. 官方文档->指南->配置小程序->全局配置，点击里面的“小程序全局配置”,然后里面可以找到tabBar的设置
2. app.json中加入：
    
    ```
    "tabBar": {
        //tabBar颜色
        "color": "#AAAAAA",
        //选中颜色
        "selectedColor": "#56B465",
        //背景色
        "backgroundColor": "#ffffff",
        "list": [
          {
            "pagePath": "pages/home/home",
            "text": "首页",
            "iconPath": "/assets/imgs/ic_tab_home_normal.png",
            "selectedIconPath": "/assets/imgs/ic_tab_home_active.png"
          },
          {
            "pagePath": "pages/rank/rank",
            "text": "榜单",
            "iconPath": "/assets/imgs/ic_tab_subject_normal.png",
            "selectedIconPath": "/assets/imgs/ic_tab_subject_active.png"
          },
          {
            "pagePath": "pages/profile/profile",
            "text": "我的",
            "iconPath": "/assets/imgs/ic_tab_profile_normal.png",
            "selectedIconPath": "/assets/imgs/ic_tab_profile_active.png"
          }
        ]
    }
    ```

## 自定义导航栏
1. 微信小程序官方设置导航栏
    1. 方式一：页面全局配置， 官方文档->指南->配置小程序->页面配置
        
        ```
        {
          //设置导航栏的背景色
          "navigationBarBackgroundColor": "#ffffff",
          //导航栏文字颜色
          "navigationBarTextStyle": "black",
          "navigationBarTitleText": "微信接口功能演示",
          "backgroundColor": "#eeeeee",
          "backgroundTextStyle": "light"
        }
        ```
    2. 方式二：通过API设置,API->界面->导航栏
        
        ```
        wx.setNavigationBarColor({
          frontColor: '#ffffff',
          backgroundColor: '#ff0000',
          animation: {
            duration: 400,
            timingFunc: 'easeIn'
          }
        })
        ```
    3. 缺点：在安卓手机显示不正常
2. 自定义导航栏
    1. 官方文档->指南->配置小程序->页面配置->点击里面的“小程序页面配置”
        1. navigationStyle：default 默认样式; custom 自定义导航栏，只保留右上角胶囊按钮
    2. 某个页面自定义导航栏
        1. 在当前页面的json文件中设置属性`"navigationStyle":"custom"`
    3. 全局配置自定义导航栏
        1. 在app.json中，window字段下设置：`"navigationStyle":"custom"`
        2. 自定义导航栏组件
            1. 在cmps文件夹下简历一个nav-bar文件夹，右击新建component(组件)，命名为nav-bar
    



