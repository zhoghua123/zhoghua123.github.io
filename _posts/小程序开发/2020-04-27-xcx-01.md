---
layout: post
title: 第六章：小程序云开发简介
category: 小程序开发
tags: 小程序
description: 小程序开发
--- 

## 简介
1. 什么是云开发？ 
    1. 传统的开发模式需要专门的后台人员开发服务用来存储数据，云开发专门提供了后台功能，不需要后台人员开发服务，前端人员直接可以操作。
2. 云开发的模式 
    ![pic](https://raw.githubusercontent.com/zhoghua123/imgsBed/master/xcxpic15.png) 
3. 云开发模式和传统模式对比
    ![pic](https://raw.githubusercontent.com/zhoghua123/imgsBed/master/xcxpic16.png) 
4. 云开发主要包含三大核心技术:
    1. 云数据库:
        1. 提供在小程序端直接对数据库进行增删改查的能力;
        2. 数据库是类似于MongoDB的文档存储的数据库，操作非常方便;
    2. 云存储:
        1. 可以在小程序端直接上传、下载、删除文件;
        2. 自带CDN，提高文件访问速度;
        3. 可以获取临时链接，支持在小程序外访问;
    3. 云函数:(对数据库、云存储能力的补充扩充)
        1. 提供了在服务器代码的执行能力;
        2. 包含微信天然的私有鉴权;
        3. 更大权限的操作数据库等;
        4. 进行云调用、HTTP请求等操作;
5. 初始化项目
    1. 打开“微信卡发者工具” -> 项目命名为“StudyCloud” ->选择项目目录 ->APPID(注意：云开发必须使用申请的id，不能使用测试号)->后端服务勾选： 小程序.云开发 ->新建
    2. 点击“微信卡发者工具” 的云开发按钮，进入到“云开发控制台”页面
        1. 点击开通 -> 环境名称：coderzhong，环境ID自动填充： coderzhong-xxxx ->点击确定即可
    3. 云开发控制台
        1. 云开发控制台包含
            1. 运营分析
            2. 数据库(云数据库)
            3. 存储(云存储)
            4. 云函数
        2. 云开发创建新环境
            1. 设置 – 环境名称 – 创建环境
            2. 在创建一个测试环境: coderzhong-dev
        3. 重要概念 – 环境和配额
            1. 环境:
                1. 一个环境对应一整套**独立的云开发资源**，包括数据库、存储空间、云函数等资源。
                2. 各个环境是相互独立的，用户开通云开发后即创建了一个环境，默认可拥有**最多两个**环境。
                3. 在实际开发中，**建议每一个正式环境都搭配一个测试环境**，所有功能先在测试环境测试完毕后再上到正式环境。 
            2. 配额:
                1. 默认有一定的免费配额(你懂的);
                2. 后期可以根据自己的业务量选择对应的更高配额;
                3. [https://developers.weixin.qq.com/miniprogram/dev/wxcloud/billing/quota.html](https://developers.weixin.qq.com/miniprogram/dev/wxcloud/billing/quota.html)
6. 云开发初始化
    1. 在小程序端开始使用云能力前，需先调用 wx.cloud.init 方法完成云能力初始化
        1. 在app.js文件中
            
            ```
            onLaunch: function () {
                if (!wx.cloud) {
                  console.error('请使用 2.2.3 或以上的基础库以使用云能力')
                } else {
                  wx.cloud.init({
                    // env 参数说明：
                    //   env 参数决定接下来小程序发起的云开发调用（wx.cloud.xxx）会默认请求到哪个云环境的资源
                    //   此处请填入环境 ID, 环境 ID 可打开云控制台查看
                    //   如不填则使用默认环境（第一个创建的环境，在云开发控制台选择的环境））
                    // env: 'my-env-id',
                    traceUser: true,
                  })
               }
            }
            ```
        2. cloud.init 有两个参数：
            1. env：后续 API 调用的默认环境配置，传入字符串形式的环 境 ID 可以指定所有服务的默认环境，传入对象可以 分别指定各个服务的默认环境，见下方详细定义
            2. traceUser： 是否在云开发控制台->运营分析->用户访问中记录        


