---
layout: post
title: 第三章：汇编语言程序设计（二）
category: 汇编
tags: 汇编
description: 汇编
---

## 汇编语言程序格式

### 汇编语言数据的定义
> 在程序中用到的所有数据必须指定其类型，数据分为常量和变量

#### 常量
1. 汇编源程序中具有固定值的数称为常量；
2. 常量可以以多种数制及字符形式出现
3. 汇编程序中常使用一下两种类型的常量
    1. 数字常量
        1. 二进制数：10100001B
        2. 八进制：76Q,335O
        3. 十进制： 98,4330
        4. 十六进制： 0FE65H
    2. 字符串常量
        1. 字符串常量表示为包含在两个单引号之间的字符，如：`’AB‘,‘123’`等
        2. 程序经编译后，单引号内的每个字符实际上是其ASCII码的形式，例如：`'AB'`,可以看成是4142H.

#### 变量的定义
1. 变量是用户为存放数据的内存单元所起的名字
2. 变量名实际上是内存单元的符号地址
3. 通常这些内存单元被分配在数据段、附加段或堆栈段，这些单元的数据在程序的运行期间可以随时修改。
4. 在汇编程序中，用数据定义伪指令为变量分配内存单元，同时可以将这些内存单元预置初值。
    1. 字节定义语句 DB
        1. 定义字节存储单元，其后的每个操作数占有一个字节单元，可以连续存放。
        2. 格式：`[变量名] DB 操作数 [,....操作数]`
        3. 举例：
            
            ```
            //单字节数据
            X DB 10   ;为变量X分配一个字节，初值是10
            Y DB ?    ;为变量Y分配一个字节，不设置初值，初值是随机值
            
            //多字节数据
            BUFFER DB 3,4,-5,-2    ;从地址BUFFER开始，连续分配4个字节，其内容分别是03H,04H,0FBH,0FEH(负数是以补码的形式在计算机中存在的)
            
            //定义字符串
            
            STRING DB 'ABCD'     ;从地址STRING开始，连续分配4个字节，其内容分别是41H,42H,43H,44H
            //定义重复数据
            BUF DB 100 DUP(0)    ;从地址BUF开始，连续分配100个字节，并将其全部赋值为0.
            复制操作符DUP用来复制某个或某些连续的存储空间，并且可以嵌套使用。
            ```
    2. 自定义语句 DW
        1. 定义字存储单元，其后的每个操作数占据两个字节，地位字节在低地址，高位字节在高地址，可以连续存放。
        2. 自定义单元的定义格式与操作数的形式与字节定义语句DB类似。
        3. 注意： 如果DW后的操作数是地址（变量名），则存入对应字单元的是地址（变量名）的偏移地址部分。
                
            ```
            DAT SEGMENT
              X DB 3,4
              Y DW -2
              ADDR DW Y
            DAT ENDS
            其中，ADDR字单元内存储的事变量Y的偏移地址
            ```
    3. 其他数据定义语句DD/DQ/DT等
        1. DD定义双字存储单元，其后的每个操作数占据4个字节
        2. DQ定义的每个数据单元占8个字节
        3. DT定义的每个数据单元占10个字节

#### 变量的属性
1. 由于存储器是分段使用的，所以对源程序中定义的变量都有以下3种属性。
    1. 段属性： 变量所在段的段基址，为该段所对应的段寄存器的值。
    2. 偏移属性：变量距段起始地址的字节数，为16位二进制无符号数。
    3. 类型属性： 变量在存储单元所占的字节长度，为整数数值，主要有BYTE(1),WORD(2),DWORD(4),DQ(8),DT(10)等。

### 汇编语言的标号
1. 标号的概念
    1. 标号是用户为程序中某条指令所起的名字，实质上是**代码段**中该指令所对应的**目标代码**在存储器内的存放地址。
    2. 标号经常在转移、调用指令中引用，作为程序转移的目标地址。
2. 标号的属性
    1. 段属性： 标号所在段的段基址，为该段所对应的段寄存器的值，即CS的值。
    2. 偏移属性： 标号所代表的指令相对于代码段首地址的字节数，为16位二进制无符号数
    3. 类型属性： 若标号所代表的指令与引用标号的指令在同一代码段内，则为NEAR类型，用0FFFFH(1)表示；否则为FAR类型，用0FFFEH（-2）表示。
    4. 可见：变量代表的事数据存储单元的地址，而标号代表的是指令存储单元的地址。

### 汇编语言的运算符和表达式
1. 汇编语言的数据或者操作数除了表示为常量、变量和标号的形式外，还可以表示成表达式的形式。
2. 注意： **表达式并不是命令，其计算或操作都是在汇编时由汇编程序完成的，在程序运行时表达式已经被他的运算结果取代了**
3. 表达式根据其运算结果的类型分为数值表达式和地址表达式。
    1. 数值表达式的运算结果是数值，没有别的属性；
    2. 地址表达式的运算结果是地址，具有段属性、偏移属性和类型属性
5. 构成表达式的运算符有5种，分别是算术运算符、逻辑运算符、关系运算符、分析运算符合合成运算符。
    1. 所有运算符如课本表：4.1 p119
    2. 这积累运算符的优先级： 4.2 p119

#### 算术运算符
1. 算术运算符共包括：加（+）、减（-）、乘（*）、除（/）、取余（MOD）、左移（SHL）、右移（SHR）共7种
2. 说明：
    1. 参加运算的数值和运算结果均是整数
    2. “/”运算的结果去两个


