---
layout: post
title: Nodejs后端开发(五)-小知识整理
category: Web开发
tags: Web开发
description: Web开发
---

## 密码加密 bcrypt
1. 哈希加密（单向加密类似MD5，不可逆）是单程加密方式:1234 => abcd 
2. 在加密的密码中加入随机字符串可以增加密码被破解的难度。
3. 使用：

    ```
    // 导入bcrypt模块
    const bcrypt = require('bcrypt');
    // 生成随机字符串 gen => generate 生成 salt 盐
    let salt = await bcrypt.genSalt(10);
    // 使用随机字符串对密码进行加密
    let pass = await bcrypt.hash('明文密码', salt);
    
    // 密码比对
    let isEqual = await bcrypt.compare('明文密码', '加密密码');
    ```
4. bcrypt依赖的其他环境 
    1. python 2.x （mac系统默认已经安装,不需要安装。可以通过:`python --version` 命令查看）
    2. node-gyp（直接全局安装）
        1. `npm install -g node-gyp`
    3. windows-build-tools (windows下才需要安装)
        1. `npm install --global --production windows-build-tools`
    4. 安装bcrypt: `npm install bcrypt`

## cookie 与 session

#### 1.cookie
1. cookie:浏览器在电脑**硬盘中**开辟的一块空间，主要供**服务器端**存储数据。
    1. cookie中的数据是以**域名**的形式进行区分的。
    2. cookie中的数据是有**过期时间**的，超过时间数据会被浏览器自动删除。
    3. cookie中的数据会随着请求被**自动**发送到服务器端。
        1. F12->Network->点击一个请求，可以看到请求头（Request Headers）中有一个Cookie字段存储的数据。
        2. 当客户端发送请求时，Cookie会随着请求头一起发送到服务端
2. **客户端的js**和**服务器端**都可以向cookie中存储数据，但是主要是用于服务端存储数据的
3. 如何查看一个网站的cookie存储数据
    1. F12->Application->Cookies
4. cookie的作用就是**服务器端向客户端存放一些临时数据**
5. Cookie缓存的流程：当客户端第一次访问服务器，服务器在做出响应的同时将一些数据存储在客户端的cookie中；当客户端再一次发送请求访问服务器，客户端就会将cookie通过请求头携带给服务器。

#### 2.session
1. 实际上就是一个对象，存储在**服务器端**的内存中，在session对象中也可以存储多条数据，每一条数据都有一 个sessionid做为唯一标识。

#### 3.cookie与session搭配使用
1. 客户端通过邮件地址、密码参数向服务器发送登录请求
2. 服务端进行参数验证，验证过后，服务端将用户的信息存储到session对象中，生成一个sessionid，并将这个sessionid响应给客户端，并存储到客户端的cookie中。
3. 当客户端下一次访问服务器时，cookie会自动发送给服务端，服务器端拿到cookie中存储的sessionid，在服务端的session对象中查找相应的信息，找到就证明已登录，反之未登录

