---
layout: post
title: WebAPI(四)-JS特效
category: Web开发
tags: Web开发
description: Web开发
--- 

## PC 端网页特效

### 元素偏移量 offset 系列
1. offset 概述
    1. offset 翻译过来就是偏移量， 我们使用 offset 系列相关属性**可以动态的得到该元素的位置（偏移）、大小等**。
        1. 获得元素距离带有定位父元素的位置
        2. 获得元素自身的大小（宽度高度）
        3. 注意： 返回的数值都不带单位
    2. offset 系列常用属性：
        
        ```
        element.offsetParent    返回作为该元素带有定位(position)的父级元素，如果父级都没有定位则返回body
        element.offsetTop       返回元素相对带有定位(position)父元素上方的偏移
        element.offsetLeft      返回元素相对带有定位(position)父元素左边框的偏移
        element.offsetWidth     返回自身包括padding、边框、内容的宽度，返回值不带单位
        element.offsetHeight    返回自身包括padding、边框、内容的高度，返回值不带单位
        ```
        ![pic](https://raw.githubusercontent.com/zhoghua123/imgsBed/master/webjs-11.png)
        
        1. 注意：offsetParent、offsetTop、offsetLeft有个关键词**带有定位**，即**父元素必须是定位元素**。
        2. 只有父元素是定位元素，这样才能返回offsetTop、offsetLeft距离父元素的顶部和左边的距离，否则就返回距离body的左边、顶部的距离
    3. 代码举例：
        
        ```
        * {
            margin: 0;
            padding: 0;
        }
        .father {
            width: 100px;
            height: 100px;
            background-color: #ff0;
            margin: 100px;
            /* position: relative; */
        }
        .son {
            width: 50px;
            height: 50px;
            background-color: #0f0;
            margin-left: 25px;
        }
        
        <div class="father">
        <div class="son"></div>
        </div>
        <script>
            var father = document.querySelector('.father');
            var son = document.querySelector('.son');
            // 距离父盒子顶部,100
            console.log(father.offsetTop);
            // 距离父盒子左边,100
            console.log(father.offsetLeft);
            // 父类不是定位元素，所以参照为body
            // 125
            console.log(son.offsetLeft);
            // 如果给father元素添加position: relative;属性，则参照物就是father
            // 100
            // console.log(son.offsetLeft);
            // 100
            console.log(son.offsetTop);
        </script>
        ```
2. offset 与 style 区别
    1. offset
        1. offset 可以得到**任意样式表**中的样式值
        2. offset 系列获得的数值是**没有单位**的
        3. offsetWidth **包含**padding+border+width
        4. offsetWidth 等属性是**只读**属性，只能获取不能赋值
        5. **所以，我们想要获取元素大小位置，用offset更合适**
    2. style
        1. style 只能得到**行内样式表**中的样式值
        2. style.width 获得的是**带有单位**的字符串
        3. style.width 获得**不包含**padding和border 的值
        4. style.width 是**可读写**属性，可以获取也可以赋值
        5. **所以，我们想要给元素更改值，则需要用style改变**
    
#### 案例使用
1. 案例1：获取鼠标在盒子内的坐标
    
    ```
    <style>
        * {
            margin: 0;
            padding: 0;
        }
        
        .box {
            width: 100px;
            height: 100px;
            margin: 100px;
            background-color: #ff0;
        }

    </style>
    <body>
        <!-- 获取鼠标点击在盒子中的坐标 -->
        <div class="box"></div>
        <script>
            var box = document.querySelector('.box');
            box.onclick = function(e){
                // 鼠标点击的位置距离文档的坐标
                console.log(e.pageX,e.pageY);
                // 盒子距离body的距离
                console.log(this.offsetTop,this.offsetLeft);
                // 计算出点击点举例盒子的坐标
                var y = e.pageY - this.offsetTop;
                var x = e.pageX - this.offsetLeft;
                console.log(x,y);
            }
        </script>
    </body>
    ```
2. 案例2：模态框弹出+拖拽
    1. 案例分析
        1. 点击弹出层， 模态框和遮挡层就会显示出来 display:block;
        2. 点击关闭按钮，模态框和遮挡层就会隐藏起来 display:none;
        3. 在页面中拖拽的原理： 鼠标按下并且移动， 之后松开鼠标
        4. 触发事件是鼠标按下 mousedown， 鼠标移动mousemove 鼠标松开 mouseup
        5. 拖拽过程: 鼠标移动过程中，获得最新的值赋值给模态框的left和top值， 这样模态框可以跟着鼠标走了
        6. 鼠标按下触发的事件源是 最上面一行，就是 id 为 title
        7. 鼠标的坐标 减去 鼠标在盒子内的坐标， 才是模态框真正的位置。
        8. 鼠标按下，我们要得到鼠标在盒子的坐标。
        9. 鼠标移动，就让模态框的坐标 设置为 ： 鼠标坐标减去盒子坐标即可，**注意移动事件写到按下事件里面。（因为只有按下了，才会移动）**
        10. 鼠标松开，就停止拖拽，就是可以让鼠标移动事件解除
    2. 代码举例：
        
        ```
        <style>
            .login-header {
                width: 100%;
                text-align: center;
                height: 30px;
                font-size: 24px;
                line-height: 30px;
            }
            ul,li,ol,dl,dt,dd,div,p,span,h1,h2,h3,h4,h5,h6,a {
                padding: 0;
                margin: 0;
            }
            .login {
                display: none;
                width: 512px;
                height: 280px;
                position: fixed;
                border: #ebebeb solid 1px;
                left: 50%;
                top: 50%;
                background: #ffffff;
                box-shadow: 0px 0px 20px #ddd;
                z-index: 9999;
                transform: translate(-50%, -50%);
            }
            .login-title {
                width: 100%;
                margin: 10px 0px 0px 0px;
                text-align: center;
                line-height: 40px;
                height: 40px;
                font-size: 18px;
                position: relative;
                cursor: move;
            }
            .login-input-content {
                margin-top: 20px;
            }
            .login-button {
                width: 50%;
                margin: 30px auto 0px auto;
                line-height: 40px;
                font-size: 14px;
                border: #ebebeb 1px solid;
                text-align: center;
            }
            .login-bg {
                display: none;
                width: 100%;
                height: 100%;
                position: fixed;
                top: 0px;
                left: 0px;
                background: rgba(0, 0, 0, .3);
            }
            a {
                text-decoration: none;
                color: #000000;
            }
            .login-button a {
                display: block;
            }
            .login-input input.list-input {
                float: left;
                line-height: 35px;
                height: 35px;
                width: 350px;
                border: #ebebeb 1px solid;
                text-indent: 5px;
            }
            .login-input {
                overflow: hidden;
                margin: 0px 0px 20px 0px;
            }
            .login-input label {
                float: left;
                width: 90px;
                padding-right: 10px;
                text-align: right;
                line-height: 35px;
                height: 35px;
                font-size: 14px;
            }
            .login-title span {
                position: absolute;
                font-size: 12px;
                right: -20px;
                top: -30px;
                background: #ffffff;
                border: #ebebeb solid 1px;
                width: 40px;
                height: 40px;
                border-radius: 20px;
            }
        </style>
        <body>
            <div class="login-header"><a id="link" href="javascript:;">点击，弹出登录框</a></div>
            <div id="login" class="login">
                <div id="title" class="login-title">登录会员
                    <span><a id="closeBtn" href="javascript:void(0);" class="close-login">关闭</a></span>
                </div>
                <div class="login-input-content">
                    <div class="login-input">
                        <label>用户名：</label>
                        <input type="text" placeholder="请输入用户名" name="info[username]" id="username" class="list-input">
                    </div>
                    <div class="login-input">
                        <label>登录密码：</label>
                        <input type="password" placeholder="请输入登录密码" name="info[password]" id="password" class="list-input">
                    </div>
                </div>
                <div id="loginBtn" class="login-button"><a href="javascript:void(0);" id="login-button-submit">登录会员</a></div>
            </div>
            <!-- 遮盖层 -->
            <div id="bg" class="login-bg"></div>
            <script>
                // 1. 获取元素
                var login = document.querySelector('.login');
                var mask = document.querySelector('.login-bg');
                var link = document.querySelector('#link');
                var closeBtn = document.querySelector('#closeBtn');
                var title = document.querySelector('#title');
                // 2. 点击弹出层这个链接 link  让mask 和login 显示出来
                link.addEventListener('click', function() {
                        mask.style.display = 'block';
                        login.style.display = 'block';
                    })
                    // 3. 点击 closeBtn 就隐藏 mask 和 login 
                closeBtn.addEventListener('click', function() {
                        mask.style.display = 'none';
                        login.style.display = 'none';
                    })
                    // 4. 开始拖拽
                    // (1) 当我们鼠标按下， 就获得鼠标在盒子内的坐标
                title.addEventListener('mousedown', function(e) {
                    var x = e.pageX - login.offsetLeft;
                    var y = e.pageY - login.offsetTop;
                    // (2) 鼠标移动的时候，把鼠标在页面中的坐标，减去 鼠标在盒子内的坐标就是模态框的left和top值
                    document.addEventListener('mousemove', move)
        
                    function move(e) {
                        login.style.left = e.pageX - x + 'px';
                        login.style.top = e.pageY - y + 'px';
                    }
                    // (3) 鼠标弹起，就让鼠标移动事件移除
                    document.addEventListener('mouseup', function() {
                        document.removeEventListener('mousemove', move);
                    })
                })
            </script>
        </body>
        ```

### 元素可视区 client 系列

### 元素滚动 scroll 系列

### 动画函数封装

### 常见网页特效案例

