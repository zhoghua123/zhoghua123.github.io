---
layout: post
title: WebAPI(一)-DOM
category: Web开发
tags: Web开发
description: Web开发
--- 

### Web APIs简介
1. JS 的组成
    1. ECMAScript: JavaScript语法
    2. Web APIs
        1. DOM: 页面文档对象模型，操作页面元素---网页
        2. BOM: 浏览器对象模型，操作浏览器---浏览器
2. Web APIs 是 JS 的应用，大量使用JS基础语法**做交互效果**
3. Web APIs 是 W3C 组织的标准
4. Web APIs 是我们 JS 所独有的部分
5. 主要学习页面交互功能

####  API 和 Web API
1. API
    1. API（Application Programming Interface,应用程序编程接口）是一些预先定义的函数，目的是提供应用程序
    2. 与开发人员基于某软件或硬件得以访问一组例程的能力，而又无需访问源码，或理解内部工作机制的细节。
    3. 简单理解： API 是给程序员提供的一种工具，以便能更轻松的实现想要完成的功能。
2. Web API
    1. Web API 是**浏览器**提供的一套**操作浏览器功能**和**页面元素**的 API ( BOM 和 DOM )。
    2. 现阶段我们主要针对于浏览器讲解常用的 API , 主要针对浏览器做交互效果。
    3. 比如我们想要浏览器弹出一个警示框， 直接使用 alert(‘弹出’)
    4. MDN 详细 API : [https://developer.mozilla.org/zh-CN/docs/Web/API]()
    5. 因为 Web API 很多，所以我们将这个阶段称为 **Web APIs**
3. API 和 Web API 总结
    1. **API 是为我们程序员提供的一个接口，帮助我们实现某种功能，我们会使用就可以了，不必纠结内部如何实现**
    2. Web API 主要是针对于浏览器提供的接口，主要针对于浏览器做交互效果。
    3. Web API 一般都有输入和输出（函数的传参和返回值），Web API 很多都是方法（函数）
    
## DOM

### DOM 简介
1. 什么是 DOM
    1. **文档对象模型**（Document Object Model，简称 DOM），**是** W3C 组织推荐的处理可扩展标记语言（HTML 或者XML）的标准**编程接口**。
    2. W3C 已经定义了一系列的 DOM 接口，通过这些 **DOM 接口可以改变网页的内容、结构和样式**。
2. DOM 树
    
    ![pic](https://raw.githubusercontent.com/zhoghua123/imgsBed/master/webjs-07.png)
    
    1. 文档：一个页面（网页）就是一个文档，DOM 中使用 **document** 表示
    2. 元素：页面中的所有标签都是元素，DOM 中使用 **element**表示
    3. 节点：网页中的所有内容都是节点（标签、属性、文本、注释等），DOM 中使用 **node**表示
    4. DOM 把以上内容都看做是对象
    
### 获取元素
1. 如何获取页面元素
    1. DOM在我们实际开发中主要用来操作元素。
    2. 获取页面中的元素可以使用以下几种方式:
        1. 根据 ID 获取
        2. 根据标签名获取
        3. 通过 HTML5 新增的方法获取
        4. 特殊元素获取

#### 根据 ID 获取
1. 使用 `getElementById()` 方法可以获取带有 ID 的元素对象。
    
    ```
    document.getElementById('id');
    ```
2. 使用 `console.dir()` 可以打印我们获取的元素对象，更好的查看对象里面的属性和方法。

#### 根据标签名获取
1. 使用 `getElementsByTagName()` 方法可以返回带有指定标签名的对象的集合。
    
    ```
    document.getElementsByTagName('标签名');
    ```
2. 注意：
    1. 因为得到的是一个对象的集合，所以我们想要操作里面的元素就需要遍历。
    2. 得到元素对象是动态的
    3. 如果获取不到元素,则返回为空的伪数组(因为获取不到对象)
    4. 父元素**必须是单个对象**(必须指明是哪一个元素对象). 获取的时候不包括父元素自己。
    
    
#### 通过 HTML5 新增的方法获取

```
document.getElementsByClassName(‘类名’)；// 根据类名返回元素对象集合
document.querySelector('选择器');// 根据指定选择器返回第一个元素对象
document.querySelectorAll('选择器');// 根据指定选择器返回
```

1. 注意：
    1. querySelector 和 querySelectorAll里面的选择器需要加符号,比如:`document.querySelector('#nav');`
    
#### 获取特殊元素（body，html）

```
doucumnet.body// 返回body元素对象
document.documentElement // 返回html元素对象
```

#### 代码举例

```
<div id="time">2020-0812</div>
<ul>
    <li>哈哈哈哈</li>
    <li>哈哈哈哈</li>
    <li>哈哈哈哈</li>
    <li>哈哈哈哈</li>
    <li>哈哈哈哈</li>
</ul>
<ul id="nav">
    <li>呵呵</li>
    <li>呵呵</li>
    <li>呵呵</li>
    <li>呵呵</li>
    <li>呵呵</li>
</ul>

<div class="test">hhh</div>
<div class="test">hhh</div>


<script>
    // 1. 通过id获取标签
    var timer = document.getElementById('time')
    console.log(timer);
    //Object
    console.log(typeof timer);
    //    打印元素对象，可以查看属性
    console.dir(timer)

    // 2. 根据标签名获取标签
    // lis元素对象的集合，以伪数组的形式存储
    var lis = document.getElementsByTagName('li');
    console.log(lis);
    for (let i = 0; i < lis.length; i++) {
       console.log(lis[i]);
    }
    //2.2获取某个元素内部的标签
    var nav =document.getElementById('nav');
    //获取某个元素内部的标签
    var navlis = nav.getElementsByTagName('li');
    console.log(navlis);
    
    //3. 通过 HTML5 新增的方法获取
    //.1根据类名获取
    var tests = document.getElementsByClassName('test')
    console.log(tests);
    //3.2 根据选择器获取
    var test = document.querySelector('.test');
    var iddiv = document.querySelector('#time')
    console.log(test);
    console.log(iddiv);
    // 3.3返回选择器所有的内容
    var testss = document.querySelectorAll('.test') 
    console.log(testss);

</script>
```

### 事件基础
1. 事件概述
    1. JavaScript 使我们有能力创建动态页面，而事件是可以被 **JavaScript 侦测到**的行为。
    2. 简单理解： 触发--- 响应机制。
    3. 网页中的每个元素都可以产生某些可以触发 JavaScript 的事件，例如，我们可以在用户点击某按钮时产生一个事件，然后去执行某些操作。
2. 事件三要素
    1. 事件源 （谁）
    2. 事件类型 （什么事件）
    3. 事件处理程序 （做啥）
    
3. 案例
    1. 三要素
        1. 获取事件源（按钮）
        2. 注册事件（绑定事件），使用 onclick
        3. 编写事件处理程序，写一个函数弹出 alert 警示框
    2. 执行事件的步骤
        1. 获取事件源
        2. 注册事件（绑定事件）
        3. 添加事件处理程序（采取函数赋值形式）
    
        ```
        //获取事件源
        var btn = document.getElementById('btn'); 
        //绑定事件
        btn.onclick = function() { //事件处理程序
            alert('你好吗'); 
        };
        ```
4. 常见的鼠标事件
    
    ```
    onclick         鼠标点击左键触发
    onmouseover     鼠标经过触发
    onmouseout      鼠标离开触发
    onfous          获取得鼠标焦点触发
    onblur          鼠标失去焦点触发
    onmousemove     鼠标移动触发
    onmouseup       鼠标弹起触发
    onmousedown     鼠标按下触发
    ```

### 操作元素
1. JavaScript 的 DOM 操作可以改变网页内容、结构和样式，我们可以利用 DOM 操作元素来改变元素里面的**内容 、属性**等。**注意**以下都是属性

#### 改变元素内容
1. 方式1：

    ```
    element.innerText
    ```

    1. 从起始位置到终止位置的内容, 但它**去除 html 标签， 同时空格和换行也会去掉**
    2. 非标准
2. 方式2：
    
    ```
    element.innerHTML
    ```

    1. 起始位置到终止位置的全部内容，**包括 html 标签，同时保留空格和换行**
    2. W3C标准，推荐使用
3. 举例：
    
    ```
    <div></div>
    <p>
        一段文字
        <span>123</span>
    </p>
    
    <script>
        // 1. innerText 
        var div = document.querySelector('div');
        // 标签直接显示，不识别字符串中的标签元素：<strong>123</strong>
        // div.innerText = '<strong>123</strong>';

        //2. innerHTML 显示结果: 加粗的 123,innerHTML可以识别字符串中的标签元素
        div.innerHTML = '<strong>123</strong>';

        //3. 这两个属性是可以读写的，获取元素中的内容
        console.log(div.innerText);
        console.log(div.innerHTML);
        
        // 4. 获取p标签内容
        var p = document.querySelector('p');
        // 一段文字 123
        console.log(p.innerText);
        /*
        会原样输出：空格+标签
        一段文字
        <span>123</span>
        */
        console.log(p.innerHTML);

    </script>
    ```

#### 标签属性操作

##### 常用元素的属性操作
1. `innerText、innerHTML` 改变元素内容
2. src、href
3. id、alt、title
    
    ```
    <button id="ldh">刘德华</button>
    <button id="zxy">张学友</button> <br>
    <img src="images/ldh.jpg" alt="">
    <script>
        // 修改元素的属性
        var btn1 = document.querySelector('#ldh');
        var btn2 = document.querySelector('#zxy');
        var img = document.querySelector('img');
        // 注册事件
        btn1.onclick =function() {
            img.src = 'images/ldh.jpg';
            img.title = '刘德华';
        }

        btn2.onclick =function() {
            img.src = 'images/zxy.jpg';
            img.title = '张学友';
        }
    </script>
    ```

##### 表单元素的属性操作
1. 利用 DOM 可以操作如下表单元素的属性：
    
    ```
    type、value、checked、selected、disabled
    ```
2. 代码举例：
    
    ```
    <button>按钮</button>
    <input type="text" value="输入内容">
    <script>
        var btn = document.querySelector('button');
        var input = document.querySelector('input');
        btn.onclick = function() {
            input.value = '被点击了';
            // 禁用按钮,this指向函数调用者
            this.disabled = true;    
        }
    </script>
    ```
3. 经典案例：密码框明文、密文切换显示
    1. 核心思路： 点击眼睛按钮，把密码框类型改为文本框就可以看见里面的密码
    2. 一个按钮两个状态，点击一次，切换为文本框，继续点击一次切换为密码框
    3. 算法：利用一个flag变量，来判断flag的值，如果是1 就切换为文本框，flag 设置为0，如 果是0 就切换为密码框，flag设置为1
        
        ```
        <style>
            .box {
                width: 400px;
                border-bottom: 1px solid #ccc;
                margin: 100px auto;
                position: relative;
            }
            .box input {
                width: 370px;
                height: 30px;
                border: 0;
                outline: none;
            }
            .box img {
                position: absolute;
                top: 2px;
                right: 2px;
                width: 24px;
            }
        </style>
        
        <body>
        <!--密码框明文、密文切换显示 -->
        <div class="box">
            <label for="">
                <img src="./images/close.png" alt="" id="eye">
            </label>
            <input type="password" id="pwd">
        </div>
        <script>
            var img = document.getElementById('eye');
            var pwd = document.getElementById('pwd');
            var flag = 0;
            img.onclick = function() {
                if(flag == 0){
                    pwd.type = 'text';
                    img.src = 'images/open.png'
                    flag = 1;
                }else {
                    pwd.type = 'password';
                    img.src = 'images/close.png'
                    flag = 0;
                }
            }
        </script>
        </body>
        ```
        
#### 样式（CSS）属性操作
1. 我们可以通过 JS 修改元素的大小、颜色、位置等样式。
    1. element.style 行内样式操作(修改的样式很少时用)
    2. element.className 类名样式操作（修改的样式很多时用）
2. **注意：**
    1. style修改：
        1. JS 里面的样式采取驼峰命名法 比如 `fontSize、 backgroundColor`
        2. JS 修改 style 样式操作，产生的是行内样式，CSS 权重比较高
    2. className修改
        1. 如果样式修改较多，可以采取操作类名方式更改元素样式。
        2. class因为是个保留字，因此使用className来操作元素类名属性
        3. className 会直接更改元素的类名，会覆盖原先的类名。
3. 例1：
    
    ```
    <style>
        div {
            width: 200px;
            height: 200px;
            background-color: #ff0;
        }
    </style>
    
    <body>
    <div></div>
    <script>
    
        var div = document.querySelector('div');
        div.onclick = function () {
            // js添加的样式会添加到行内样式
            // 修改背景色，css属性采用驼峰标识
            this.style.backgroundColor = '#0f0';
            // 修改尺寸
            this.style.width = '300px';
        }
    </script>
    </body>
    ```
4. 例2：
    
    ```
    <style>
        .orgin {
            width: 200px;
            height: 200px;
            background-color: #ff0;
        }
        /* 要修改的样式，样式很多 */
        .change {
            background-color: #0f0;
            color: #fff;
            font-size: 25px;
            margin-top: 100px;
        }
    </style>s
    <body>
    <div class="orgin">234</div>
    <script>
    
        var div = document.querySelector('div');
        div.onclick = function () {
            // 通过className,修改当前元素的类名
            this.className = 'change';
            // 保留原先的属性，再添加上新的属性
            this.className = 'orgin change';
        }
    </script>
    </body>
    ```

#### 操作元素总结
1. 操作元素是 DOM 核心内容
2. 操作元素
    1. 操作元素内容
        1. innerText
        2. innerHTML
    2. 操作常见元素属性
        1. src、href、title、alt等
    3. 操作表单元素属性
        1. type、value、disabled等
    4. 操作元素样式属性
        1. element.style
        2. className

### 节点操作


