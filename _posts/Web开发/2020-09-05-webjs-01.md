---
layout: post
title: MongoDB、模板引擎artTemplate
category: Web开发
tags: Web开发
description: Web开发
--- 

## MongoDB数据库

### 数据库概述及环境搭建
1. 为什么要使用数据库
    1. 动态网站中的数据都是存储在数据库中的
    2. 数据库可以用来持久存储客户端通过表单收集的用户信息
    3. 数据库软件本身可以对数据进行高效的管理
2. 什么是数据库
    1. 数据库即存储数据的仓库，可以将数据进行有序的分门别类的存储。
    2. **它是**独立于语言之外的**软件**，可以通过该软件开放的API去操作它。
    3. 常见的数据库软件有：mysql、mongoDB、oracle。
4. 为什么选择mongoDB？ 
    1. 因为mongoDB这款数据库（软件）开放的API也是Javascript语法，跟node.js一样
    2. 在数据库中存储的都是json对象格式
    3. mongoDB对于Nodejs开发更加友好
    4. mysql对于php开发人员更适合，Nodejs也可以操作mysql
5. MongoDB数据库下载安装
    1. 下载地址：[https://www.mongodb.com/download-center/community](https://www.mongodb.com/download-center/community)
    2. 根据当前的操作系统类型下载相应的安装包-安装(window环境下安装)
    3. Mac环境下安装:(使用 brew 安装,不需要下载)
        1. 执行安装命令：
            
            ```
            brew tap mongodb/brew
            brew install mongodb-community@4.4
            ```
            
            1. @ 符号后面的 4.4 是最新版本号。
        2. 安装后信息：
            1. 配置文件：`/usr/local/etc/mongod.conf`
            2. 日志文件路径：`/usr/local/var/log/mongodb`
            3. 数据存放路径：`/usr/local/var/mongodb`
        3. 运行 MongoDB
            1. 我们可以使用 brew 命令或 mongod 命令来启动服务。
                1. brew 启动：
                    
                    ```
                    brew services start mongodb-community@4.4
                    ```
                2. brew 停止
                    
                    ```
                    brew services stop mongodb-community@4.4
                    ```
            2. mongod 命令后台进程方式启动：
                1. 启动
                    
                    ```
                    mongod --config /usr/local/etc/mongod.conf --fork
                    ```
                2. 这种方式启动要关闭可以进入 mongo shell 控制台来实现：
                    
                    ```
                    > db.adminCommand({ "shutdown" : 1 })
                    ```
6. MongoDB可视化软件
    1. MongoDB可视化操作软件，是使用图形界面操作数据库的一种方式。
    2. 下载MongoDB Compass可视化操作软件：
        1. 在上面的MongoDB下载地址中，点击Tools，选择MongoDB Compass，下载，然后安装
    3. 操作数据库的方式：
        1. 通过Node.js调用数据库提供的API，数据库软件反馈操作结果
        2. 通过可视化界面操作数据库，数据库通过界面反馈操作结果
7. 数据库相关概念
    1. 在一个数据库软件中可以包含多个数据仓库，在每个数据仓库中可以包含多个数据集合，每个数据集合中可以包含多条文档（具体的数据）。
        
        ```
        术语             解释说明
        database        数据库，mongoDB数据库软件中可以建立多个数据库
        collection      集合，一组数据的集合，可以理解为JavaScript中的数组
        document        文档，一条具体的数据，可以理解为JavaScript中的对象
        field           字段，文档中的属性名称，可以理解为JavaScript中的对象属性
        ```
    
#### 使用图形化界面MongoDB Compass操作数据库
1. 打开MongoDB Compass软件
2. 有3个列选项
    1. New Connection
    2. Favorites
    3. Recents
3. New Connection
    1. 该页面的作用是通过这个MongoDB Compass软件去连接电脑中的数据库  
4. 连接数据库
    1. windows下，启动MongoDB软件，然后打开MongoDB Compass软件点击连接即可
    2. Mac下，终端执行`brew services start mongodb-community`启动MongoDB，然后打开MongoDB Compass软件点击连接即可
5. 连接之后数据库MongoDB有默认的三个仓库
    1. admin
    2. config
    3. local

#### 使用Node.js操作数据库
1. 使用Node.js操作MongoDB数据库需要依赖Node.js第三方包mongoose
    1. cd到项目根目录下，执行`npm init -y`初始化package.json文件
    2. `npm install mongoose`命令下载mongoose
2. 启动MongoDB
    1. windows：在命令行工具中运行`net start mongoDB`即可启动MongoDB，否则MongoDB将无法连接。
    2. mac：使用`brew services start mongodb-community`启动MongoDB
3. 停止MongoDB
    1. windows： 执行`net stop mongoDB`
    2. mac：执行`brew services stop mongodb-community`
4. 数据库连接
    1. 使用mongoose提供的connect方法即可连接数据库。
        
        ```
        const mongoose = require('mongoose');
        mongoose.connect('mongodb://localhost/playground',{useNewUrlParser: true,useUnifiedTopology: true})
        .then(() => console.log('数据库连接成功'))
        .catch(err => console.log('数据库连接失败', err));
        ```
        
        1. connect:参数
            1. url:
                1. 参数数据库的地址，使用的协议为mongodb协议
                2. localhost/：数据库地址
                3. playground： 要连接的数据库的名字
            2. 参数2：默认传参
    2. 停止连接：`ctrl+c`
5. 创建数据库
    1. 在MongoDB中**不需要显式创建数据库**，如果正在使用的数据库不存在，**MongoDB会自动创建**。

### MongoDB增删改查操作

