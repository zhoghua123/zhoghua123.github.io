---
layout: post
title: 地图系列之一CoreLocation
category: iOS开发
tags: Map
description: Map
---

# 简介
1. 在移动互联网时代，移动app能解决用户的很多生活琐事，比如
    1. 周边：找餐馆、找KTV、找电影院等等
    2. 导航：根据用户设定的起点和终点，进行路线规划，并指引用户如何到达
2. 在上述应用中，都用到了**定位**和**地图**功能，在iOS开发中，要想加入这2大功能，必须基于2个框架进行开发
    1. CoreLocation ：用于地理定位，地理编码，区域监听等（着重功能实现）
    2. MapKit ：用于地图展示，例如大头针，路线、覆盖层展示等（着重界面展示）
    3. 说明: 这两个框架MapKit相对来说更加重量级,MapKit定位是相对于CoreLocation来做的,因此要先研究CoreLocation
3. 2个热门专业术语
    1. LBS ：Location Based Service(基于定位的服务)
    2. SoLoMo ：Social Local Mobile（索罗门）

# CoreLocation框架的使用
1. CoreLocation框架使用前提
    1. 导入框架（Xcode5.0之后可以省略）
    2. 导入主头文件`#import <CoreLocation/CoreLocation.h>` 
2. CoreLocation框架使用须知
    1. CoreLocation框架中所有数据类型的前缀都是CL
    2. CoreLocation中使用CLLocationManager对象来做用户定位
    
## 用户隐私的保护

## CLLocationManager
1. CLLocationManager的常用操作
    
    ```
    开始更新用户位置
    - (void)startUpdatingLocation;
    
    停止更新用户位置
    - (void) stopUpdatingLocation;
    
    当调用了startUpdatingLocation方法后，就开始不断地请求、刷新用户的位置，一旦请求到用户位置就会调用代理的下面方法
    - (void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations;
    locations参数里面装着CLLocation对象
    
    为了严谨起见，最好在使用定位功能之前判断当前应用的定位功能是否可用
    CLLocationManager有个类方法可以判断当前应用的定位功能是否可用
      + (BOOL)locationServicesEnabled;

    ```
2. 常见属性
    
    ```
    每隔多少米定位一次
    @property(assign, nonatomic) CLLocationDistance distanceFilter;
    
    定位精确度（越精确就越耗电）
    @property(assign, nonatomic) CLLocationAccuracy desiredAccuracy;
    
    CLLocation用来表示某个位置的地理信息，比如经纬度、海拔等等

    经纬度
    @property(readonly, nonatomic) CLLocationCoordinate2D coordinate;
    
    海拔
    @property(readonly, nonatomic) CLLocationDistance altitude;
    
    路线，航向（取值范围是0.0° ~ 359.9°，0.0°代表真北方向）
    @property(readonly, nonatomic) CLLocationDirection course;
    
    移动速度（单位是m/s）
    @property(readonly, nonatomic) CLLocationSpeed speed;
    
    用- (CLLocationDistance)distanceFromLocation:(const CLLocation *)location方法可以计算2个位置之间的距离


    ```


