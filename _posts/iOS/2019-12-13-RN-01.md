---
layout: post
title: 跨平台开发RN
category: iOS开发
tags: React Native 
description: 跨平台开发的研究
--- 

## React Native 简介
1. 什么是React Native？
    1. Facebook于2015年9月15日发布React Native
    2. 它充分利用了Facebook现有的业务轮子, 其核心设计理念：既拥有Native的用户体验、又保留React的开发效率。
    3. React Native基本完成了对多端的支持，实现了真正意义上的面向配置开发: **开发者可以灵活的使用HTML和CSS布局,使用React语法构建组件,实现：H5, Android, iOS 多端代码的复用**。
    4. 广大开发者可以使用JavaScript和React开发跨平台移动应用
    5. React Native提倡组件化开发: 即提供一个个封装好的组件，组件相互嵌套形成新的组件
    6. 目前react native在iOS上仅支持ios7以上，Android仅支持Android4.1以上版本；
        1. github地址: [https://github.com/facebook/react-native](https://github.com/facebook/react-native)
        2. 官网文档: [http://facebook.github.io/react-native/docs/getting-started.html](http://facebook.github.io/react-native/docs/getting-started.html)
        3. 中文网文档：[http://reactnative.cn/docs/0.42/getting-started.html](http://reactnative.cn/docs/0.42/getting-started.html)（非官方，但文档不错
    
### 配置React Native开发环境
1. 环境需求
    1. 安装`Homebrew` （方法百度）
    2. 安装`WatchMan`
        1. 该插件用于监控bug文件，并且可以触发指定的操作
        2. 安装方式：`brew install watchman`
    3. 安装`Flow`
        1. flow是一个 JavaScript 的静态类型检查器，建议安装它，以方便找出代码中可能存在的类型错误
        2. 安装方式：`brew install flow`
2. React Native安装
    1. 安装React Native ：`npm install -g react-native-cli`
3. React Native的第一个应用
    1. 执行命令,生成一个工程
        1. cd到工程文件夹下
        2. 执行命令：`react-native init RNTestProduct`
    2. 注意:由于众所周知的网络原因，react-native命令行从npm官方源拖代码时会遇上麻烦。请将npm仓库源替换为国内镜像：
        
        ```
        npm config set registry https://registry.npm.taobao.org
        npm config set disturl https://npm.taobao.org/dist
        ```
    3. 目录结构分析
        1. ios： iOS的原生项目
            1. 打开可以用Xcode直接运行
            2. 运行过程中会自动打开终端，运行react-native服务器
        2. android: 安卓的原生项目
        3. node_modules: 是为`Node.js`存放和管理npm包资源，也包含React Native框架文件。
4. Android开发环境需求
    1. 安装最新版的JDK: `ttp://www.oracle.com/technetwork/java/javase/downloads`，然后安装
    2. 下载安装Android Studio：`https://developer.android.com/studio/index.html`
        1. 安装时可以不勾选：`Android Virtual Device`,不需要这个模拟器
5. 安装Genymotion虚拟机
    1. Genymotion是一个第三方模拟器，它比Google官方的模拟器更易设置且性能更好。但是，它只针对个人用户免费。
    2. Genymotion官网注册: `https://www.genymotion.com/`
    3. 下载genymotion： `https://www.genymotion.com/download/`
    4. 打开Genymotion,如果你尚未安装VirtualBox,它有可能会提示你安装，根据提示下载安装即可，然后再次点开
    5. 登录账号，有很多模拟器供下载。也可以自定义模拟器下载。
    6. 按下⌘+M可以打开开发者菜单(在安装并启动了React Native应用之后)
6. 运行安卓原生项目
    1. 打开Genymotion，选择一个模拟器机型运行起来
    2. 用Android Studio打开React Native项目目录的Android文件夹，然后运行即可
        1. Android Studio会自动识别模拟器
    3. 注意：**一定要将react-native的服务器启动起来，否则运行项目报错**
        1. 可以用Xcode运行一下iOS原生项目，react-native服务就会自动在终端启动。
7. 编辑器的使用
    1. 使用webstorm，用webstorm打开`RNTestProduct`文件
    2. 点击右上角的Add Configuration->点击左上角的`+`->在列表中选择React Native
    3. 修改名称，然后选择应用，OK即可。
8. 管理React Native库的版本
    1. 由于RN的版本更新非常快，因此要对版本进行管理
    2. 查看本地的React Native的版本
        
        ```
        react-native --version
        ```
    3. 更新本地的React Native的版本
        
        ```
        npm update -g react-native-cli
        ```
    4. 查询react-native的npm包最新版本
        
        ```
        npm info react-native
        ```
    5. 升级或者降级npm包的版本
        
        ```
        npm install --save react-native@0.18
        ```
        
### React Native基本使用
1. 打开genymotion，选择一个模拟器运行
2. 启动RN服务：
    1. cd到项目根目录，输入：`react-native start`
3. 用AS打开项目目录下的Android源码，然后运行，此时项目在genymotion模拟器上运行 
4. 此时就可以关闭AS了，AS的功能就是让RN的项目安装在genymotion上
5. 重新打开模拟器项目。
6. 在`APP.js`中写代码，双击R刷新模拟器就可以看到修改的内容
7. 注意：
    1. AS仅仅是将项目安装在genymotion上，只要没有修改Android源码，就不需要重新运行
    2. RN的开发条件：
        1. 启动RN服务器
        2. 将项目安装到genymotion上
        3. 一共编辑器编写代码
    3. 下次运行就不需要AS了。
8. 模拟器的使用方法：
    
    ```
    双击R，刷新模拟器
    cmd+M：打开菜单
    ```


